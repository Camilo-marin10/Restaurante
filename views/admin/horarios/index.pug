extends ../../layout/index

block contenido
    div(class="py-12 px-4 sm:px-6 lg:px-8 bg-gray-50")
        h2(class="text-4xl font-extrabold text-red-800 mb-8 border-b pb-2 tracking-tight") Gestión de Horarios de Atención

        p(class="text-gray-600 mb-8") Define los horarios en que el restaurante está abierto para recibir reservas. Si un día no está activo, no se permitirán reservas ese día.

        if errores
            each error in errores
                div(class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4" role="alert")
                    p(class="font-bold") Error
                    p #{error.msg}

        if mensajeExito
            div(class="bg-green-100 border-l-4 border-green-500 text-green-700 p-4 mb-4" role="alert")
                p(class="font-bold") Éxito
                p #{mensajeExito}


        div(class="bg-white shadow-2xl rounded-xl overflow-hidden border border-gray-100")
            div(class="px-6 py-5 sm:px-8 bg-red-50 border-b border-red-200")
                h3(class="text-xl leading-6 font-bold text-red-800") Horario Semanal

            form(method="POST" class="w-full" action="/admin/horarios")
                input(type="hidden" name="_csrf" value=csrfToken)

                div(class="overflow-x-auto")
                    table(class="min-w-full divide-y divide-gray-200")
                        thead(class="bg-gray-100")
                            tr
                                th(class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider w-1/4") Día de la Semana
                                th(class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider w-1/4") Activo
                                th(class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider w-1/4") Hora Apertura
                                th(class="px-6 py-3 text-left text-xs font-bold text-gray-600 uppercase tracking-wider w-1/4") Hora Cierre
                        
                        tbody(class="bg-white divide-y divide-gray-100")
                            if horarios && horarios.length
                                each horario in horarios
                                    tr(class="hover:bg-gray-50")
                                        td(class="px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900") #{horario.nombre_dia}
                                        
                                        td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-600")
                                            label(class="flex items-center space-x-2 cursor-pointer")
                                                input(
                                                    type="checkbox"
                                                    name=`activo_${horario.dia_semana}`
                                                    checked=horario.activo
                                                    id=`activo_${horario.dia_semana}` 
                                                    class="form-checkbox h-5 w-5 text-red-600 rounded-lg shadow-md transition duration-150 ease-in-out"
                                                    onchange=`
                                                        const activo = this.checked;
                                                        document.getElementById('estado_${horario.dia_semana}').textContent = activo ? 'Abierto' : 'Cerrado';
                                                        document.getElementById('apertura_${horario.dia_semana}').disabled = !activo;
                                                        document.getElementById('cierre_${horario.dia_semana}').disabled = !activo;
                                                    `
                                                )
                                             
                                                span(class="text-sm font-medium" id=`estado_${horario.dia_semana}`)= horario.activo ? 'Abierto' : 'Cerrado'
                                        
                                        td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-600")
                                            input(
                                                type="time"
                                                name=`apertura_${horario.dia_semana}`
                                                value=horario.hora_apertura_input
                                                disabled=!horario.activo 
                                                id=`apertura_${horario.dia_semana}` 
                                                class="w-full md:w-32 border-gray-300 rounded-md shadow-sm focus:border-red-500 focus:ring-red-500"
                                            )
                                        
                                        td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-600")
                                            input(
                                                type="time"
                                                name=`cierre_${horario.dia_semana}`
                                                value=horario.hora_cierre_input
                                                disabled=!horario.activo
                                                id=`cierre_${horario.dia_semana}` 
                                                class="w-full md:w-32 border-gray-300 rounded-md shadow-sm focus:border-red-500 focus:ring-red-500"
                                            )
                            else
                                tr
                                    td(colspan="4" class="p-8 text-center text-gray-500 text-lg") No se pudo cargar la configuración de horarios.

                div(class="px-6 py-5 bg-gray-50 border-t border-gray-200")
                    input(
                        type="submit"
                        value="Guardar Cambios"
                        class="w-full md:w-auto px-6 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 cursor-pointer"
                    )