extends ../../layout/index

block contenido
    div(class="py-10")
        h2(class="text-3xl font-bold text-gray-900 mb-6") #{titulo}
        
        div(class="flex justify-between items-center mb-6")
            h3(class="text-xl font-semibold text-gray-700") Total de Reservas: #{reservas.length}
            a(href="/admin/reservas/crear" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-md uppercase text-sm transition duration-300") Nueva Reserva

        if reservas.length
            div(class="bg-white shadow rounded-lg overflow-hidden")
                div(class="overflow-x-auto")
                    table(class="min-w-full divide-y divide-gray-200")
                        thead(class="bg-gray-50")
                            tr
                                th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase") Código
                                th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase") Cliente
                                th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase") Mesa
                                th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase") Fecha/Hora
                                th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase") Personas
                                th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase") Duración
                                th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase") Estado
                                th(class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase") Acciones
                        
                        tbody(class="bg-white divide-y divide-gray-200")
                            each reserva in reservas
                                tr
                                    td(class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900") 
                                        span(class="font-mono text-xs") #{reserva.codigo_reserva.substring(0, 8)}
                                    
                                    td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-500")
                                        | #{reserva.cliente.nombre} #{reserva.cliente.apellido}
                                        p(class="text-xs text-gray-400") T: #{reserva.cliente.telefono}

                                    td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-500")
                                        | #{reserva.mesa.nombre}
                                        p(class="text-xs text-gray-400") Cap: #{reserva.mesa.capacidad}

                                    td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-500")
                                        p #{reserva.fecha_reserva}
                                        p(class="font-semibold") #{reserva.hora_reserva.substring(0, 5)} hrs.

                                    td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-500") #{reserva.numero_personas}

                                    td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-500") #{reserva.duracion_estimada} hrs.
                                    
                                    td(class="px-6 py-4 whitespace-nowrap")
                                        - let color = 'bg-gray-200 text-gray-800'
                                        if reserva.estado === 'Confirmada'
                                            - color = 'bg-green-100 text-green-800'
                                        else if reserva.estado === 'Pendiente'
                                            - color = 'bg-yellow-100 text-yellow-800'
                                        else if reserva.estado === 'Cancelada' || reserva.estado === 'No-Show'
                                            - color = 'bg-red-100 text-red-800'
                                        else if reserva.estado === 'En Curso'
                                            - color = 'bg-blue-100 text-blue-800'

                                        span(class=`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${color}`) #{reserva.estado}
                                        
                                        // Formulario para cambiar estado rápidamente (ejemplo)
                                        form(method="POST" action=`/admin/reservas/estado/${reserva.id}` class="mt-2")
                                            input(type="hidden" name="_csrf" value= csrfToken)
                                            select(name="nuevoEstado" onchange="this.form.submit()" class="block w-full text-xs border border-gray-300 rounded-md focus:ring-indigo-500 focus:border-indigo-500")
                                                - const estados = ['Pendiente', 'Confirmada', 'En Curso', 'Completada', 'Cancelada', 'No-Show']
                                                each estadoOpt in estados
                                                    option(value=estadoOpt selected= reserva.estado === estadoOpt ? true : false)= estadoOpt
                                    
                                    td(class="px-6 py-4 whitespace-nowrap text-sm font-medium flex gap-2")
                                        a(href=`/admin/reservas/editar/${reserva.id}` class="text-indigo-600 hover:text-indigo-900")
                                            | Editar
                                        
                                        form(method="POST" action=`/admin/reservas/eliminar/${reserva.id}`)
                                            input(type="hidden" name="_csrf" value= csrfToken)
                                            button(type="submit" class="text-red-600 hover:text-red-900 ml-2")
                                                | Eliminar
        else
            div(class="text-center py-10")
                p(class="text-gray-500") No hay reservas registradas. 
                a(href="/admin/reservas/crear" class="text-indigo-600 font-medium") ¡Crea la primera reserva!