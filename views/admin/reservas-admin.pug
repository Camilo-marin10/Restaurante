extends ../layout/index

block contenido
    div(class="py-12 px-4 sm:px-6 lg:px-8 bg-gray-50")
        h1(class="text-4xl font-extrabold text-red-800 mb-2 tracking-tight")= titulo
        p(class="text-lg text-gray-700 mb-8 border-b pb-4") Lista y gestiona todas las reservas.

        if error
            div(class="p-4 mb-6 bg-red-100 border-l-4 border-red-500 text-red-700 rounded-lg font-semibold" role="alert")= error
        
        if reservas.length > 0
            div(class="bg-white shadow-2xl rounded-xl overflow-hidden border border-gray-100")
                div(class="overflow-x-auto")
                    table(class="min-w-full divide-y divide-gray-200")
                        thead(class="bg-red-50")
                            tr
                                th(class="px-6 py-3 text-left text-xs font-bold text-red-700 uppercase tracking-wider") Código
                                th(class="px-6 py-3 text-left text-xs font-bold text-red-700 uppercase tracking-wider") Cliente
                                th(class="px-6 py-3 text-left text-xs font-bold text-red-700 uppercase tracking-wider") Fecha/Hora
                                th(class="px-6 py-3 text-left text-xs font-bold text-red-700 uppercase tracking-wider") Mesa Asignada
                                th(class="px-6 py-3 text-left text-xs font-bold text-red-700 uppercase tracking-wider") Personas
                                th(class="px-6 py-3 text-left text-xs font-bold text-red-700 uppercase tracking-wider") Estado
                                th(class="px-6 py-3 text-left text-xs font-bold text-red-700 uppercase tracking-wider") Acción
                        tbody(class="bg-white divide-y divide-gray-100")
                            each reserva in reservas
                                tr(class="hover:bg-amber-50 transition duration-150")
                                    td(class="px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900")= reserva.codigo_reserva.substring(0, 8)
                                    td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-600")= reserva.usuario.nombre + ' ' + reserva.usuario.apellido
                                    td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-600")= reserva.fecha_reserva + ' ' + reserva.hora_reserva.substring(0, 5)
                                    td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-600")= reserva.mesa.nombre
                                    td(class="px-6 py-4 whitespace-nowrap text-sm text-gray-600")= reserva.numero_personas
                                    td(class="px-6 py-4 whitespace-nowrap")
                                        - 
                                            let estadoClase = 'bg-gray-200 text-gray-700'; 
                                            if (reserva.estado === 'Confirmada') estadoClase = 'bg-green-100 text-green-800';
                                            else if (reserva.estado === 'Pendiente') estadoClase = 'bg-amber-100 text-amber-800';
                                            else if (reserva.estado === 'En Curso') estadoClase = 'bg-red-100 text-red-800';
                                            else if (reserva.estado === 'Cancelada' || reserva.estado === 'No-Show') estadoClase = 'bg-red-200 text-red-900';
                                            else if (reserva.estado === 'Completada') estadoClase = 'bg-gray-300 text-gray-700';
                                        
                                        span(class=`${estadoClase} inline-flex px-3 py-1 text-xs leading-5 font-bold rounded-full shadow-sm`)
                                            = reserva.estado

                                    td(class="px-6 py-4 whitespace-nowrap")
                                        form(method="POST" action="/admin/reservas/" + reserva.id + "/estado")
                                            input(type="hidden" name="_csrf" value=csrfToken) 
                                            div(class="flex items-center space-x-2")
                                                select(name="nuevo_estado" class="block w-36 rounded-lg border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500 text-sm p-2")
                                                    each estado in estados
                                                        option(value=estado selected=(reserva.estado === estado))= estado
                                                button(type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-3 rounded-lg text-xs transition duration-150 transform hover:scale-105 shadow-md") Actualizar
        else
            div(class="p-6 bg-amber-50 border-l-4 border-orange-500 text-orange-800 rounded-lg font-semibold shadow-md") No hay reservas para gestionar en este momento.